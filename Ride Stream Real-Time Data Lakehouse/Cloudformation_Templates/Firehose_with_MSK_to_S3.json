{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "Create a Kinesis Firehose Delivery Stream that reads from MSK Serverless and writes to S3",
  "Resources": {
    "MyMSKBatchDeliveryStream": {
      "Type": "AWS::KinesisFirehose::DeliveryStream",
      "Properties": {
        "DeliveryStreamName": "MSK_Batch",
        "DeliveryStreamType": "MSKAsSource",
        "MSKSourceConfiguration": {
          "MSKClusterARN": "arn:aws:kafka:us-east-1:12345678910:cluster/MSK/ba7eb6b6-307e-432d-af38-d0bb09003f2e-s1",
          "TopicName": "Ride_Stream",
          "AuthenticationConfiguration": {
            "Connectivity": "PRIVATE",
            "RoleARN": "arn:aws:iam::12345678910:role/service-role/KinesisFirehoseServiceRole-MSK_Batch-us-east-1-1757831436533"
          }
        },
        "ExtendedS3DestinationConfiguration": {
          "RoleARN": "arn:aws:iam::12345678910:role/service-role/KinesisFirehoseServiceRole-MSK_Batch-us-east-1-1757831436533",
          "BucketARN": "arn:aws:s3:::aws-glue-assets-12345678910-us-east-1",
          "Prefix": "RAW/",
          "BufferingHints": {
            "IntervalInSeconds": 300,
            "SizeInMBs": 5
          },
          "CompressionFormat": "UNCOMPRESSED",
          "ErrorOutputPrefix": "errors/"
        }
      }
    }
  },
  "Outputs": {
    "DeliveryStreamARN": {
      "Description": "ARN of the Kinesis Firehose Delivery Stream",
      "Value": {
        "Ref": "MyMSKBatchDeliveryStream"
      }
    },
    "DeliveryStreamName": {
      "Description": "Name of the Kinesis Firehose Delivery Stream",
      "Value": "MSK_Batch"
    }
  }
}
